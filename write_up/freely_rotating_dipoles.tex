
\documentclass[12pt]{amsart}
\usepackage{geometry} % see geometry.pdf on how to lay out the page. There's lots.
\usepackage{mathtools}
\geometry{a4paper} % or letter or a5paper or ... etc
% \geometry{landscape} % rotated page geometry

% See the ``Article customise'' template for come common customisations

\title{Dynamics of Two Freely Rotating Dipoles}
\author{Peter Haugen}
%\date{} % delete this line to display the current date

%%% BEGIN DOCUMENT
\begin{document}

\maketitle
\tableofcontents

\section{Introduction}
A system comprised of two unrestricted spherical magnetic dipoles presents an interesting and fundamental set of phenomenon as two magnetic dipoles is amongst the simplest non-trivial macroscopic magnetic systems. Understanding their dynamics could prove useful in contexts such as the large dipole field proposed to provide a solar wind umbrella for mars.

\section{Describing the System}
Intrinsic properties of the two dipoles are: their respective radii, which we shall label as $a_1$ and $a_2$, their masses, $m_1$ and $m_2$, and magnitudes of their dipole moments, $\mu_1$ and $\mu_2$.
\subsection{Coordinates}
\subsubsection{Cartesian}

Each of the dipoles has a location $\vec r_1$ and $\vec r_1$ along with an orientation for the dipole $\phi_1$ and $\phi_2$, measured from the x-axis.
\subsubsection{Center Of Mass}
We can define a more appropriate set of coordinates and quantities using these fundamental descriptors. 

The total and reduced mass

\begin{equation}
m_t = m_1+m_2
\qquad
m_r = \frac{m_1m_2}{m_1+m_2}
\end{equation}

The center of mass 
\begin{equation}
\vec R = \frac{m_1 \vec r_1+m_2 \vec r_2}{m_t}
\end{equation}

And the displacement of dipole 2 from dipole 1
\begin{equation}
\vec r 
=  \vec r_2-\vec r_1 
= r (\cos(\theta) \hat x+\sin(\theta) \hat y)
\end{equation}


\subsection{Hamiltonian}
\subsubsection{Energies}
The kinetic energy, T, in the center of mass coordinates can be found to be
%citing taylor mechanics for the reduced kinetic
\begin{equation}
T = \frac{1}{2}(
	m_t \dot R^2
	+m_r \dot r^2
	+m_r r^2 \dot \theta^2
	+ I_1 \dot \phi_1^2
	+ I_2 \dot \phi_2^2
)
\end{equation}
The potential energy for dipole 1 is merely it's dot product with the local field, which in this case is caused entirely by dipole 2.
\begin{equation}
U_1 = -\vec \mu_1 \cdot \vec B_2
\end{equation}

With the magnetic field for a dipole at some point of interest $\vec r_i$ begin given by

\begin{equation}
\vec B_2 = 
\frac{\mu_0}{4\pi}(
	3\frac{\vec \mu_2 \cdot (\vec r_i - \vec r_2)}{|\vec r_i - \vec r_2|^5}(
	\vec r_i - \vec r_2
	)
	-\frac{\vec \mu_2}{|\vec r_i - \vec r_2|^3}
)
\end{equation}

Using our definition for $\vec r$ we can simplify the potential down to

\begin{equation}
U_1 = 
\frac{\mu_0}{4\pi}
\frac{1}{r^3}(
	\vec \mu_1 \cdot \vec \mu_2
	-3(
		\vec \mu_2 \cdot \hat r
		)(
		\vec \mu_1 \cdot \hat r		
		)
)
\end{equation}

This is obviously symmetric under substitution of 1 for 2 and vice versa so we have a total interaction potential of

\begin{equation}
U =
U_1+U_2
= 
2U_1
\end{equation}

Which when expanding the dot products out in terms of all three respective angles leaves us with

\begin{equation}
U(\phi_1, \phi_2, \theta, r) =
-\frac{\mu_0}{4\pi}
\frac{\mu_1 \mu_2}{2}
\frac{1}{r^3}(
	\cos(\phi_1-\phi_2)
	+3\cos(\phi_1+\phi_2 -2\theta)
)
\end{equation}

Having an expression for kinetic and potential energy, the lagrangian is as follows.

\begin{equation}
  \begin{multlined}
    L=T-U=
    \frac{1}{2}(
        m_t \dot R^2
        +m_r \dot r^2
        +m_r r^2 \dot \theta^2
        + I_1 \dot \phi_1^2
        + I_2 \dot \phi_2^2
    )
    \\
    +
    \frac{\mu_0}{4\pi}
    \frac{\mu_1 \mu_2}{2}
    \frac{1}{r^3}(
        \cos(\phi_1-\phi_2)
        +3\cos(\phi_1+\phi_2 -2\theta)
    )
  \end{multlined}
\end{equation}

\subsubsection{Momenta}

The first observation we make is that the potential energy is independent of the center of mass coordinates making the corresponding momenta a constant of motion and we will proceed assuming we are in the inertial frame where it is 0 and R is 0. Determining the other momenta we use the relationship $\partial_{\dot q_i} L =p_i$ to arrive at

\begin{subequations}
    \begin{equation}
        \partial_{\dot \phi_1} L = I_1\dot \phi_1 = p_{\phi_1}
    \end{equation}
    \begin{equation}
        \partial_{\dot \phi_2} L =I_2\dot \phi_2 = p_{\phi_2}
    \end{equation}
    \begin{equation}
        \partial_{\dot \theta} L =m_r r^2 \dot \theta = p_{\theta}
    \end{equation}
    \begin{equation}
        \partial_{\dot r} L = m_r \dot r = p_r
    \end{equation}
\end{subequations}

Allowing us to find the Hamiltonian with the expression of 

\begin{equation}
H=L+\Sigma_i p_i \dot q_i
=
\frac{1}{2}(
	\frac{p_r^2}{m_r}
	+\frac{p_\theta^2}{m_r r^2}
	+\frac{p_{\phi_1}^2}{I_1}
	+\frac{p_{\phi_2}^2}{I_2}
)+U(\phi_1,\phi_2,\theta)
\end{equation}
\subsection{Dimensionless coordinates}
To get at the essentials of the system we will examine in a natural system of coordinates. First we will characterize the second dipole in terms of the first such that 
$m_2=\alpha m_1$,   
$a_2=\beta a_1$,
$\mu_2=\gamma \mu_1$. This lets us rewrite the energies as
%I = 2/5 mr^2
\begin{subequations}
    \begin{equation}
        T=\frac{1}{2}\left (
	\frac{(1+\alpha)m_1}{\alpha m_1^2} p_r^2
	+\frac{(1+\alpha)m_1}{\alpha m_1^2} \frac{p_\theta^2}{r^2}
	+p_{\phi_1}^2 \frac{5}{2m_1a_1^2}
	+p_{\phi_2}^2 \frac{1}{\alpha\beta^2} \frac{5}{2m_1a_1^2}      
        \right )
    \end{equation}
    \begin{equation}
        U=
	    -\frac{\mu_0}{4\pi}
	    \frac{\gamma \mu_1^2}{2}
	    \frac{1}{r^3}(
	        \cos(\phi_1-\phi_2)
	        +3\cos(\phi_1+\phi_2 -2\theta)
	    )
    \end{equation}
\end{subequations}

If we go on to define our units as follows: 
$L_0=2a_1$ for length,
$F_0=3\mu_0 \mu_1^2/(2\pi L_0^4)$ for force,
$F_0L_0$ for energy,
$T_0=\sqrt{m_1L_0/F0}$ for time,
$\mu_1$ for magnetic moment,
$T_0^{-1},T_0^{-2}$ for angular velocities and accelerations,
$m_1L_0/T_0$ for linear momentum and 
$m_1L_0^2/T_0$ for angular momentum. This let's us rewrite the energies

\begin{subequations}
    \begin{equation}
        T=\frac{1}{2}\left (
	\frac{(1+\alpha)}{\alpha } p_r^2
	+\frac{(1+\alpha)}{\alpha } \frac{p_\theta^2}{r^2}
	+10 p_{\phi_1}^2 
	+\frac{10}{\alpha\beta^2} p_{\phi_2}^2      
        \right )
    \end{equation}
    \begin{equation}
        U=
	    -\frac{\gamma}{12}
	    \frac{1}{r^3}(
	        \cos(\phi_1-\phi_2)
	        +3\cos(\phi_1+\phi_2 -2\theta)
	    )
    \end{equation}
\end{subequations}

Let us finally make two more assumptions. First, that the two spheres are identical, $\alpha=\beta=\gamma=1$. Second, that there is some contact potential preventing the two sphere's from overlapping that prohibits r from getting less than 1. These two assumptions produce the hamiltonian we'll be investigating for the remainder of our paper

\begin{equation}
  \begin{multlined}
	H=T+U=
	\frac{1}{2}\left (
	2 p_r^2
	+2 \frac{p_\theta^2}{r^2}
	+10 p_{\phi_1}^2 
	+10 p_{\phi_2}^2      
        \right )
        \\
	-
	\frac{1}{12}
	\frac{1}{r^3}(
	        \cos(\phi_1-\phi_2)
	        +3\cos(\phi_1+\phi_2 -2\theta)
	    )+U_C
  \end{multlined}
\end{equation}

\section{Analysis}
\subsection{Analytic Results}

\subsubsection{Equilibrium Analysis}
Let us first examine the equations of motion and see if there exist any equilibria between the spheres while they are in contact with each other ($r=1$). The hamiltonian equations of motion we find are

\begin{subequations}
    \begin{equation}\label{fphi1}
        -\partial_{\phi_1} H = 
	- \frac{1}{12} \sin{\left (\phi_{1} - \phi_{2} \right )} - \frac{1}{4} \sin{\left (\phi_{1} + \phi_{2} - 2 \theta \right )}
    \end{equation}
    \begin{equation}\label{fphi2}
        -\partial_{\phi_2} H =
	\frac{1}{12} \sin{\left (\phi_{1} - \phi_{2} \right )} - \frac{1}{4} \sin{\left (\phi_{1} + \phi_{2} - 2 \theta \right )}
    \end{equation}
    \begin{equation}\label{ftht}
        -\partial_{\theta} H =
        \frac{1}{2} \sin{\left (\phi_{1} + \phi_{2} - 2 \theta \right )}
    \end{equation}
    \begin{equation}\label{fr}
        -\partial_{r} H = 
        2 p_{\theta}^{2} - \frac{1}{4} \cos{\left (\phi_{1} - \phi_{2} \right )} - \frac{3}{4} \cos{\left (\phi_{1} + \phi_{2} - 2 \theta \right )}
    \end{equation}
\end{subequations}

Inspecting equation \ref{ftht} we see immediately that orbital momentum is static if $\phi_{1} + \phi_{2} - 2 \theta = j \pi$ where j is any integer. Using that as a constraint we then see that spin momenta are both static if the previous equation holds and $\phi_{1} + \phi_{2} = k\pi$ where k is an integer independent of j. These two constraints produce a set of curves of equilibrium where

\begin{subequations}
	\begin{equation}
		\phi_1 = \frac{j+k}{2}\pi +\theta
	\end{equation}
	\begin{equation}
		\phi_2 = \frac{j-k}{2}\pi +\theta
	\end{equation}
\end{subequations}

all the forces on angular momenta are 0. However since our hamiltonian is periodic over $2\pi$ we're interested in (j,k) permuting through 0 and 1. This leaves us with 4 curves, until we consider the constraint that \ref{fr} must be negative to maintain contact. If j is odd, then we're left with a resulting radial force f $1/2$, and we lose contact. So we've narrowed down from an infinite number of equilibrium curves to two, which, using the j-k notation are 0-0 and 0-1.



\subsubsection{Normal Mode Analysis}
Equilibria and equations of motion in hand we can do small angle perturbations. Noting that near an equilibrium point $\Gamma_i$ the changes in momenta will be small we can do a multi-variable taylor expansion and produce the expression.

\begin{equation}\label{taylor_force}
	\dot p_n 
	=
	-\partial_{q_n}H
	\approx 
	\Sigma_m \partial_{q_m}(-\partial_{q_n} H)|_{\Gamma_i} q_m 
\end{equation}

If we define elements in a matrix 
$K_{n,m}= \partial_{q_m}(-\partial_{q_n} H)|_{\Gamma_i}$

We can rephrase \ref{taylor_force} as 

\begin{equation} \label{matrix_force}
	\vec{ \dot{ p }} \approx \widehat K \vec q
\end{equation}

To get this amenable to simple periodic solutions, we would like to recast the momentum vector in terms of a time derivative of our position.

\begin{equation}
	\dot{ q_n } = \partial_{p_n} H
\end{equation}

If we define elements in a diagonal matrix as 
$M_{n,n}=1/(\frac{d}{dt} \partial_{p_n} H)$
then we can rewrite \ref{matrix_force} as 

\begin{equation}
	\widehat M \vec{ \ddot{ q }} \approx \widehat K \vec q
\end{equation}

Assuming simple periodic solutions of the form $\vec q = \vec a e^{i\omega t}$ allows us to recast the above as

\begin{equation}
	( 
	\widehat K + \omega^2 \widehat M
	)  \vec{ a}e^{i\omega t} \approx 0
\end{equation}

If we treat the approximation as an equality, it will only hold for non-trivial motion if the determinant of the matrix $\widehat K - \omega^2 \widehat M$ is 0. The normal modes are the eigen vectors and values of the previous matrix.

\subsubsection{Isomorphisms}

\subsection{Numerical Results}
\subsubsection{Method}
\subsubsection{Periodic Solutions}

\end{document}
